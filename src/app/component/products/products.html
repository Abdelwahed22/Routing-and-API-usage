<div class="products-container">
  <!-- Stats Section -->
  <div class="stats-section">
    <div class="stats-item">
      <h4>{{ filteredProducts.length }}</h4>
      <p>Products Shown</p>
    </div>
    <div class="stats-item">
      <h4>{{ TotalOrderPrice | currency }}</h4>
      <p>Total Order Price</p>
    </div>
    <div class="stats-item">
      <h4>{{ categorys.length }}</h4>
      <p>Total Categories</p>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <div class="filter-header">
      <h3>üîç Filter by Category</h3>
      <p class="active-filter">Currently viewing: <strong>{{ getSelectedCategoryName() }}</strong></p>
    </div>
    <div class="filter-controls">
      <select 
        class="category-select"
        [(ngModel)]="selectedccategoryid"
        (ngModelChange)="onCategoryChange()"
        name="category"
        id="category"
      >
        <option [ngValue]="0">All Categories</option>
        <option *ngFor="let category of categorys" [ngValue]="category.id">
          {{ category.name }}
        </option>
      </select>
      <button 
        class="btn-clear-filter"
        (click)="clearFilter()"
        *ngIf="selectedccategoryid !== 0"
      >
        ‚úï Clear Filter
      </button>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="products-grid" *ngIf="filteredProducts.length > 0">
    <ng-container *ngFor="let product of filteredProducts; trackBy: trackitem; let i = index">
      <div class="product-card">
        <img 
          [src]="product.imgUrl" 
          class="product-image" 
          alt="{{product.name}}"
        >
        <div class="product-body">
          <h5 class="product-title">{{ product.name }}</h5>
          <p class="product-price">${{ product.price }}</p>
          
          <p 
            class="product-quantity"
            [ngClass]="{
              'quantity-out': product.quantity === 0,
              'quantity-low': product.quantity > 0 && product.quantity <= 5
            }"
          >
            <ng-container *ngIf="product.quantity === 0">
              Out of Stock
            </ng-container>
            <ng-container *ngIf="product.quantity === 1">
              Last Item Available
            </ng-container>
            <ng-container *ngIf="product.quantity > 1 && product.quantity <= 5">
              Only {{ product.quantity }} left!
            </ng-container>
            <ng-container *ngIf="product.quantity > 5">
              {{ product.quantity }} in stock
            </ng-container>
          </p>

          <div class="product-input-group">
            <input 
              type="number" 
              #quantity 
              min="1" 
              max="{{ product.quantity }}"
              placeholder="Qty"
              [disabled]="product.quantity === 0"
            >
            <button 
              class="btn-buy"
              (click)="buy(quantity.value, product.price)"
              [disabled]="product.quantity === 0"
            >
              Buy Now
            </button>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <!-- No Products Message -->
  <div class="no-products" *ngIf="filteredProducts.length === 0">
    <h3>üì¶ No products available</h3>
    <p>No products found in the selected category.</p>
    <button class="btn-clear-filter" (click)="clearFilter()">
      View All Products
    </button>
  </div>
</div>